@using Common
@model TelerikMovies.Web.Models.Movie.DetailedMovieViewModel
@{
    ViewBag.Title = "Details";
    var id = Model.Id.ToString();
    var date = Model.ReleaseDate.ToString("dd MMM yyyy");
    var userImgUrl = Session[Constants.UserImgUrl]?.ToString() ?? Url.Content("~/Img/no-image.png");
    var saveCommentUrl = Url.Action("SaveComment", "Comments");
    var deletCommentUrl = Url.Action("DeleteComment", "Comments");
    var partialUrlForComments = Url.Action("GetAllNotDeletedCommentsForAMovie", "Comments", new { id = id });
    var genres = string.Join("  , ", Model.Genres.Select(x => x.Name));
    var likeAMovie = Url.Action("Like", "Vote");
    var dislikeAMovie = Url.Action("Dislike", "Vote");

}



<div class="row">
    <div class="col s12 m12 l5">
        <div class="container movie-foto-container">
            <img id="movie-photo" class="materialboxed responsive-img z-depth-5" width="270" src="@(Model.ImgUrl)" />
        </div>
        <br />
        <div class="row">
            <div class="offset-s2 col s9">
                <span>Release Date: @date</span>
            </div>
        </div>
        <div class="row">
            <div class="offset-s2 col s9">
                <span>Genres: @genres</span>
            </div>
        </div>
        <div class="row">
            <div id="like-movie" class="offset-s3 col s3">
                <i class="material-icons left vote">thumb_up</i>
                <span id="like-numbers">@Model.Likes</span>
            </div>
            <div id="dislike-movie" class="col s3">
                <i class="material-icons left vote">thumb_down</i>
                <span id="dislike-numbers">@Model.Dislikes</span>
            </div>
        </div>
    </div>
    <div class="col s12 m12 l7">
        <h4 class="title-shadow">@Model.Name</h4>
        <div class="video-container z-depth-5">
            <iframe src="@Model.TrailerUrl" frameborder="0" allowfullscreen></iframe>
        </div>
        <div class="row">
            <div class="input-field col s12">
                <span>Info: </span>
                @Html.DisplayFor(m => m.Description)
            </div>
        </div>
        @Html.Action("GetAllNotDeletedCommentsForAMovie", "Comments", new { id = id })
        <input id="MovieId" type="hidden" value="@id" />
        <input id="UserName" type="hidden" value="@User.Identity.Name" />
        <input id="UserImgUrl" type="hidden" value="@userImgUrl" />
        <input id="SaveCommentUrl" type="hidden" value="@saveCommentUrl" />
        <input id="DeletCommentUrl" type="hidden" value="@deletCommentUrl" />
        <input id="RenderPartialComments" type="hidden" value="@partialUrlForComments" />
        <input id="LikeAMovieUrl" type="hidden" value="@likeAMovie" />
        <input id="DislikeAMovieUrl" type="hidden" value="@dislikeAMovie" />
    </div>

</div>

@section scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="~/Scripts/PageScripts/details-movie.js"></script>
}

@section css{
    <link href="~/Content/PageCss/detail-movie.css" rel="stylesheet" />
}
